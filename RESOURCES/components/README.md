# RESOURCES/components — OS-level firmware blobs

These files are required to build a complete `update.swu` / `update.bin`
using the `-r` flag of the top-level `build.sh`.  They are **not** stored in
this repository because they are large binary blobs derived from the official
ELEGOO firmware image.

---

## How to populate this directory

### Option A — Extract from an official ELEGOO firmware `.bin`

1. Download an official ELEGOO Centauri Carbon firmware release, e.g.:

   ```bash
   curl -L -o base.bin \
     "https://download.chitubox.com/chitusystems/chitusystems/public/printer/firmware/release/1/ca8e1d9a20974a5896f8f744e780a8a7/1/01.01.46/2025-10-22/f9bd2b9b1926408ca238de8e7eac69b6.bin"
   ```

2. Decrypt the `.bin` to a ZIP and extract the raw SWU archive:

   ```bash
   # from the repo root
   python3 tools/cc_swu_decrypt.py base.bin /tmp/base.zip
   unzip /tmp/base.zip -d /tmp/base_extracted
   ```

3. Unpack the SWU CPIO archive into this directory:

   ```bash
   cd RESOURCES/components
   cpio -idv < /tmp/base_extracted/update/update.swu
   ```

   After this step the following files will be present here:

   | File             | Description |
   |------------------|-------------|
   | `sw-description` | SWUpdate metadata (partition layout + SHA-256 hashes) |
   | `boot0`          | BROM first-stage bootloader |
   | `uboot`          | U-Boot second-stage bootloader |
   | `boot-resource`  | Boot splash / env resources |
   | `kernel`         | Linux kernel + DTB image |
   | `rootfs`         | squashfs root filesystem |
   | `dsp0`           | Xtensa HiFi4 DSP firmware |
   | `cpio_item_md5`  | MD5 manifest (regenerated by build script — can be ignored) |

### Option B — Provide your own components

Place the seven files listed above directly in this directory.
`sw-description` must follow the SWUpdate libconfig format and list each
component with a `filename` and `sha256` field — the build script will
update the SHA-256 hashes automatically after injecting the freshly built
`app` binary into `rootfs`.

---

## What the build script does with these files

When you run:

```bash
./build.sh -v 1.1.46 -p e100_lite -r RESOURCES/
```

the script will:

1. Build the MCU firmware (`upgrade_sg.bin`, `upgrade_extruder.bin`)
2. Build the firmware application (`app`)
3. Copy these component files into a working directory
4. Unpack `rootfs` (squashfs), replace `/app/app` and the MCU firmware images
5. Rebuild the squashfs rootfs (`mksquashfs -comp xz`)
6. Recompute SHA-256 hashes in `sw-description`
7. Sign `sw-description` (if a key is present in `RESOURCES/KEYS/`)
8. Repack everything into `out/update.swu`
9. Wrap into the encrypted `out/update_e100_lite_1.1.46.bin`

---

> **Note:** The `rootfs` file from the official firmware is replaced only at
> the application layer — OS packages, kernel modules, and drivers come from
> the base rootfs you extracted above.  Never commit these binary blobs to the
> repository.
